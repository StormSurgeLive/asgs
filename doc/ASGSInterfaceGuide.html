<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="AsciiDoc 8.6.8">
<title>The ASGS Interface Guide</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}


#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


@media screen {
  body {
    max-width: 50em; /* approximately 80 characters wide */
    margin-left: 16em;
  }

  #toc {
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    width: 13em;
    padding: 0.5em;
    padding-bottom: 1.5em;
    margin: 0;
    overflow: auto;
    border-right: 3px solid #f8f8f8;
    background-color: white;
  }

  #toc .toclevel1 {
    margin-top: 0.5em;
  }

  #toc .toclevel2 {
    margin-top: 0.25em;
    display: list-item;
    color: #aaaaaa;
  }

  #toctitle {
    margin-top: 0.5em;
  }
}
</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(2);
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>The ASGS Interface Guide</h1>
<span id="author">Jason Fleming</span><br>
<span id="email" class="monospaced">&lt;<a href="mailto:jason.fleming@seahorsecoastal.com">jason.fleming@seahorsecoastal.com</a>&gt;</span><br>
<span id="revnumber">version 2013,</span>
<span id="revdate">October 2013, Seahorse Coastal Consulting</span>
<br><span id="revremark"></span>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="http://www.seahorsecoastal.com">
<img src="figures/SCC_logo.png" alt="Seahorse Coastal Consulting">
</a>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_executive_summary">Executive Summary</h2>
<div class="sectionbody">
<div class="paragraph"><p>The ADCIRC Surge Guidance System (ASGS) provides real time output
from the ADCIRC or ADCIRC+SWAN models for analysis and
interpretation by downstream applications. An interface
specification is an invaluable tool that facilitates reliable
coordination between the ASGS and downstream applications while
enabling independent development processes.</p></div>
<div class="paragraph"><p>As a result, this guide was created as a living document to detail
the interface contract the ASGS and its downstream applications.
This contract consists of the following three components: (1) the
run.properties files for each forecast ensemble member; (2) the
opendap server configuration; and (3) the format of the results files
themselves.</p></div>
<div class="paragraph"><p>Not all downstream applications will rely on every aspect of the
interface described herein. Rather, each downstream application will
use only a subset of this specification. However, all instances of
the ASGS are required to adhere to all aspects of specification in
order to provide assurance of compatibility to all downstream
application developers.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_run_properties">Run Properties</h2>
<div class="sectionbody">
<div class="paragraph"><p>A run.properties file is produced for each forecast ensemble run
from the ASGS, and placed in the same results directory as the output
files for the forecast run.</p></div>
<div class="paragraph"><p>A sample of the run.properties file is shown below, organized into
document subsections according to the nature of various properties.
Definitions of these properties will be added later.</p></div>
<div class="sect2">
<h3 id="_input">Input</h3>
<div class="paragraph"><p>The following properties describe the type of input that was used to
generate the results.</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>storm class : TS
storm name : KAREN
track_raw_dat : bal122013.dat
track_raw_fst : al122013.fst
year : 2013
storm : 12
modified : n
mesh : sl15_2010_HSDRRS_2012_v9
RunType : Forecast
ADCIRCgrid : sl15_2010_HSDRRS_2012_v9
stormnumber : 12
stormname : KAREN
advisory : 10
currentcycle :
currentdate :</pre>
</div></div>
<div class="dlist"><div class="title">Definitions</div><dl>
<dt class="hdlist1">
RunStartTime
</dt>
<dd>
<p>
    Date and time in yyyyMMDDHH24 format, generally assumed to be in the
    GMT time zone unless otherwise indicated. It represents the time of
    the most recent hotstart file, that is, the date and time at the end
    of the most recent nowcast or hindcast period. It does not represent
    the start of the forecast period, or the time that the forecast
    was issued.
</p>
</dd>
<dt class="hdlist1">
currentcycle
</dt>
<dd>
<p>
    This two digit hour is in a 24 hour format and padded with a leading
    zero. This hour is equal to the hour from the RunStartTime value.
</p>
</dd>
<dt class="hdlist1">
currentdate
</dt>
<dd>
<p>
    The end date of the most recent nowcast or hindcast period, including
    the two digit year, month, and day. The value of this property
    is the same as year, month, and day from the RunStartTime value.
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_output">Output</h3>
<div class="paragraph"><p>The following properties indicate the presence, name, and format
of the output (results) files.</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>Water Surface Elevation Stations File Name : fort.61.nc
Water Surface Elevation Stations Format : netcdf
Water Surface Elevation File Name : fort.63.nc
Water Surface Elevation Format : netcdf
Barometric Pressure Stations File Name : fort.71.nc
Barometric Pressure Stations Format : netcdf
Wind Velocity Stations File Name : fort.72.nc
Wind Velocity Stations Format : netcdf
Barometric Pressure File Name : fort.73.nc
Barometric Pressure Format : netcdf
Wind Velocity File Name : fort.74.nc
Wind Velocity Format : netcdf
Maximum Water Surface Elevation File Name : maxele.63.nc
Maximum Water Surface Elevation Format : netcdf
Maximum Current Speed File Name : maxvel.63
Maximum Current Speed Format : ascii
Maximum Wind Speed File Name : maxwvel.63.nc
Maximum Wind Speed Format : netcdf
Minimum Barometric Pressure File Name : minpr.63.nc
Minimum Barometric Pressure Format : netcdf</pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_downstream">Downstream</h3>
<div class="paragraph"><p>The following properties provide information for use by particular
downstream applications for uses ranging from load balancing,
presentation to different audiences, labeling results, etc.</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>ceraServer : cera0
asgs : nc
intendedAudience :
downloadurl :
prodID : SADCsl15_2010_HSDRRS_2012_v9-UNC_vortex-nws19_20131005T1200_20131005T1200_20131007T1200_12&lt;field&gt;_Z.nc.gz</pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_analysis">Analysis</h3>
<div class="paragraph"><p>The following properties provide key bits of data that describe how the
results were generated.</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>InitialHotStartTime : 4276800.00000000
RunStartTime : 2013100512
RunEndTime : 2013100712
ColdStartTime : 2013081700
WindModel : vortex-nws19
Model : PADCIRC</pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_hpc_resources">HPC Resources</h3>
<div class="paragraph"><p>The following properties provide data about the High Performance
Computing (HPC) resources that were involved in the production of
results, which may be used in troubleshooting or performance analysis.</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>directory storm : /projects/ncfs/data/asgs15784/10/nhcConsensus
hostname : hatteras.renci.org
instance : corpsbackup3
forecastEnsembleMemberNumber : 0
cpurequest : 480
ncpu : 480
numwriters : 0</pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_thredds_catalog_service">THREDDS Catalog Service</h2>
<div class="sectionbody">
<div class="paragraph"><p>To facilitate the publication, distribution, and access of ASGS results to
dowstream applications, we are using THREDDS/OPeNDAP as a data access protocol
between the ASGS instance that is generating results and any downstream
applications that provide further analysis and visualization.  Unidata&#8217;s
THREDDS DataServer (TDS) is a web server that provides metadata and data sccess
for scientific dadtasets using several remote access protocols.  One such
protocol is OPeNDAP.  As such, the configuration details of this service are
critical to reliable compatibility with downstream applications.  OPeNDAP can
be used directly in applications to retrieve data, as through a service request
to a TDS, or as implemented for example in the MATLAB toolbox nctoolbox.
Capabilities and details of using TDS and OPeNDAP are available at
<a href="http://www.unidata.ucar.edu/software/thredds/current/tds/">http://www.unidata.ucar.edu/software/thredds/current/tds/</a> and
<a href="http://www.opendap.org/">http://www.opendap.org/</a></p></div>
<div class="paragraph"><p>There are three main steps to the setup of THREDDS for ASGS:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Install the THREDDS application on a publically accessible computer
and configure a catalog for ASGS the XML configuration file for the server;
</p>
</li>
<li>
<p>
Populate the THREDDS/ASGS server with model output into a defined
and required directory hierarchy; and
</p>
</li>
<li>
<p>
Generate a catalog file that describes the contents on the THREDDS server.
</p>
</li>
</ol></div>
<div class="paragraph"><p>Each of these steps are briefly described below. However, a detailed and
up-to-date description of the setup and configuration of a TDS are fully
described at the following URL, because there is no requirement that files
posted in the manner described originate from ADCIRC.  Any non-rectangular
model that conforms to the data format and metadata specifications can be
served this way.</p></div>
<div class="paragraph"><p><a href="https://docs.google.com/document/d/1iHHf4FN1ivGe039l_L0StuHB7d2VveAuzQsz8HVUkHA/pub">https://docs.google.com/document/d/1iHHf4FN1ivGe039l_L0StuHB7d2VveAuzQsz8HVUkHA/pub</a></p></div>
<div class="sect2">
<h3 id="_thredds_opendap_configuration">THREDDS/OPeNDAP Configuration</h3>
<div class="paragraph"><p>We use a Unidata THREDDS Data Server to serve ASGS output and the underlying
web server for a THREDDS Data Server (TDS) is tomcat5, not apache. If tomcat5
is not running on the file server, install this first.  Instructions are at:</p></div>
<div class="paragraph"><p><a href="http://www.unidata.ucar.edu/projects/THREDDS/tech/tds4.3/tutorial/index.html">http://www.unidata.ucar.edu/projects/THREDDS/tech/tds4.3/tutorial/index.html</a>
<a href="http://www.unidata.ucar.edu/projects/THREDDS/tech/tds4.3/tutorial/Checklist.html">http://www.unidata.ucar.edu/projects/THREDDS/tech/tds4.3/tutorial/Checklist.html</a></p></div>
<div class="paragraph"><p>The THREDDS app will be under the &lt;$tomcat5&gt;/webapps location, and its catalog
configuration files are in &lt;$tomcat5&gt;/content/thredds.  OPeNDAP is a java class
under the THREDDS server.</p></div>
<div class="paragraph"><p>Edit &lt;$tomcat5&gt;/content/thredds/threddsConfig.xml for the local installation.</p></div>
<div class="paragraph"><p>Once the TDS is running, create a catalog for ASGS output. The xml file
&lt;$tomcat5&gt;/content/thredds/catalog.xml is the root catalog for TDS
configuration.  An example of this root catalog is shown below, where three
services are enabled; OPeNDAP, HTTP, and UDDC.  The catalogRef tag points to
the asgs.xml file, located in the same directory and an example is listed
below.</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;catalog name="ASGS THREDDS DATA SERVER"
     xmlns="http://www.unidata.ucar.edu/namespaces/thredds/InvCatalog/v1.0"
     xmlns:xlink="http://www.w3.org/1999/xlink"&gt;</pre>
</div></div>
<div class="literalblock">
<div class="content monospaced">
<pre>&lt;service name="all" base="" serviceType="compound"&gt;
   &lt;service name="odap" serviceType="OpenDAP" base="/thredds/dodsC/" /&gt;
   &lt;service name="http" serviceType="HTTPServer" base="/thredds/fileServer/" /&gt;
   &lt;service name="uddc" serviceType="UDDC" base="/thredds/uddc/"/&gt;
   &lt;!-- test comment --&gt;
   &lt;!--service name="wcs" serviceType="WCS" base="/thredds/wcs/" /--&gt;
   &lt;!--service name="wms" serviceType="WMS" base="/thredds/wms/" /--&gt;
   &lt;!--service name="ncss" serviceType="NetcdfSubset" base="/thredds/ncss/" /--&gt;
&lt;/service&gt;</pre>
</div></div>
<div class="literalblock">
<div class="content monospaced">
<pre>&lt;catalogRef xlink:title="ASGS Output" xlink:href="asgs.xml" name=""/&gt;</pre>
</div></div>
<div class="literalblock">
<div class="content monospaced">
<pre>&lt;/catalog&gt;</pre>
</div></div>
<div class="paragraph"><p>Example asgs.xml catalogRef file:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;catalog name="ADCIRC/PADCSWAN Results from RENCI"
        xmlns="http://www.unidata.ucar.edu/namespaces/thredds/InvCatalog/v1.0"
        xmlns:xlink="http://www.w3.org/1999/xlink"&gt;</pre>
</div></div>
<div class="literalblock">
<div class="content monospaced">
<pre>&lt;service name="all" base="" serviceType="compound"&gt;
  &lt;service name="odap" serviceType="OpenDAP" base="/thredds/dodsC/" /&gt;
  &lt;service name="http" serviceType="HTTPServer" base="/thredds/fileServer/" /&gt;
  &lt;service name="uddc" serviceType="UDDC" base="/thredds/uddc/"/&gt;
  &lt;service name="uddc" serviceType="ISO" base="/thredds/iso/"/&gt;
&lt;/service&gt;</pre>
</div></div>
<div class="literalblock">
<div class="content monospaced">
<pre>&lt;datasetScan
      name="ASGS"
      ID="ASGSTCResults"
      path="ASGS"
      location="/projects/ncfs/opendap/data/tc"&gt;</pre>
</div></div>
<div class="literalblock">
<div class="content monospaced">
<pre>   &lt;serviceName&gt;all&lt;/serviceName&gt;
   &lt;addDatasetSize/&gt;
   &lt;metadata inherited="false"&gt;
   &lt;documentation type="summary"&gt;
           Results produced by the ASGS system at MyLocation
   &lt;/documentation&gt;
&lt;/metadata&gt;
&lt;filter&gt;
   &lt;include wildcard="*"/&gt;
   &lt;exclude wildcard="LOGS" atomic="false" collection="true"/&gt;
&lt;/filter&gt;
&lt;/datasetScan&gt;</pre>
</div></div>
<div class="literalblock">
<div class="content monospaced">
<pre>&lt;/catalog&gt;</pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_directory_hierarchy">Directory Hierarchy</h3>
<div class="paragraph"><p>The results files from the ASGS are posted in a particular directory hierarchy
that enables us to have multiple instances of the ASGS on multiple machines
producing results for multiple ensemble members on multiple meshes.</p></div>
<div class="paragraph"><p>Put model output files into the following directory structure on the THREDDS
server (ASGS can be configured to do this):</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>&lt;$SP&gt;/StormName/AdvisoryNumber/AdcircGrid/Machine/Instance/EnsembleName</pre>
</div></div>
<div class="paragraph"><p>where $SP is the starting/entry point into the THREDDS catalog.  Here is an
example of a fully qualified URL to an ADCIRC output file on RENCI’s THREDDS
server:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>http://opendap.renci.org:1935/thredds/dodsC/tc/nam/2013052300/nc6b/blueridge.renci.org/2/namforecast</pre>
</div></div>
<div class="paragraph"><p>There is actually no requirement on these directory names, except that they
exist.  In particular, the Instance can be used as a tag to denote specific
instances of ASGS, such as “NOAATestRuns”. A run.properties file must accompany
each ensemble member simulation.  This file is automatically generated by ASGS,
but can generated by some other process as needed, if the simulations are not
being carried out by an ASGS instance.</p></div>
</div>
<div class="sect2">
<h3 id="_catalog">Catalog</h3>
<div class="paragraph"><p>There is, unfortunately, no way to interrogate a thredds server to get a text
file that describes the data content of the server.  Methods are being
developed that will do this for a THREDDS server, but these methods are not
ready for production use.  In lieu of this, RENCI has developed an automated
cataloging script that allows a url-retrieve of the catalog file for each ASGS
TDS.  This catalog generator can be run periodically in cron to maintain an
up-to-date listing of the TDS content.</p></div>
<div class="paragraph"><p>The current version of the catalog file generator is described in detail at this URL:</p></div>
<div class="paragraph"><p><a href="https://docs.google.com/document/d/1iHHf4FN1ivGe039l_L0StuHB7d2VveAuzQsz8HVUkHA/pub">https://docs.google.com/document/d/1iHHf4FN1ivGe039l_L0StuHB7d2VveAuzQsz8HVUkHA/pub</a></p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_output_files">Output Files</h2>
<div class="sectionbody">
<div class="paragraph"><p>Adherence to community-defined, accepted and adopted conventions for data
formats and metadata content are critical for model interoperbility, workflow
development, and end-user applications.  To facilitate wide accessibility to
ADCIRC output through THREDDS Data Servers, ADCIRC/ASGS outputs netCDF files
(optionally specified in the fort.15 file).  These files must also have
metadata (global, dimension, and variable attributes) that conform to NetCDF
Climate and Forecast (CF) Metadata Conventions with extensions for
non-rectangular grid models (CF-UGRID).</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">Make sure that ADCIRC and ADCPREP are compiled with netCDF4 support with
compression.</td>
</tr></table>
</div>
<div class="paragraph"><p>It is critical for ADCIRC netCDF4 files to maintain strict CF-UGRID compliance.
This extension to CF conventions allows applications to discover, access, and
process data in uniform ways and without having to make assumptions about the
content of the data files.  This is the default for ASGS-generated output.</p></div>
<div class="paragraph"><p>There is no technical requirement that the files be generated by ADCIRC.  As
long as files are posted that are netCDF CF-UGRID compliant, any application
that can handle ADCIRC files can also handle other model files, including SLOSH
when properly formatted.</p></div>
<div class="paragraph"><p>Information on CF and CF-UGRID can be found at:</p></div>
<div class="paragraph"><p><a href="http://cf-pcmdi.llnl.gov/documents/cf-conventions">http://cf-pcmdi.llnl.gov/documents/cf-conventions</a></p></div>
<div class="paragraph"><p><a href="https://github.com/ugrid-conventions/ugrid-conventions">https://github.com/ugrid-conventions/ugrid-conventions</a></p></div>
<div class="sect2">
<h3 id="_climate_and_forecast_standards">Climate and Forecast Standards</h3>
<div class="paragraph"><p>Description of the relevant parts of the CF standards that must
be implemented in the ADCIRC and ADCIRC+SWAN NetCDF4 output files
for compatibility with downstream applications.</p></div>
<div class="paragraph"><p><a href="http://cf-pcmdi.llnl.gov/documents/cf-conventions">http://cf-pcmdi.llnl.gov/documents/cf-conventions</a></p></div>
</div>
<div class="sect2">
<h3 id="_netcdf_metadata">NetCDF Metadata</h3>
<div class="paragraph"><p>Any other key pieces of NetCDF metadata that are used by downstream
applications and must be provided for compatibility.</p></div>
<div class="paragraph"><p>This must include a time stamp indicating the cold start date.</p></div>
<div class="paragraph"><p><em><strong> JASON:  I don&#8217;t see where this is in the metadata.  I see that there is a "cs:" in the fort.15 header, and as a consequence its in the global attribute "description",  but I don&#8217;t see it as an attribute.  I think this is a good idea, though, to put it as a global attribute in each file. </strong></em></p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_appendix_a_this_document">Appendix A: This Document</h2>
<div class="sectionbody">
<div class="paragraph"><p>This document was prepared from the text file ASGSInterfaceGuide.txt
using software called asciidoc (<a href="http://www.methods.co.nz/asciidoc/">http://www.methods.co.nz/asciidoc/</a>).
The document can be formatted as an html page with the command</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>asciidoc --backend html5 -a toc2 ASGSInterfaceGuide.txt</pre>
</div></div>
<div class="paragraph"><p>or formatted as a pdf with the command</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>a2x --format=pdf -a toc2 ASGSInterfaceGuide.txt</pre>
</div></div>
</div>
</div>
</div>
<div id="footnotes"><hr></div>
<div id="footer">
<div id="footer-text">
Version 2013<br>
Last updated 2013-10-09 10:39:16 EDT
</div>
</div>
</body>
</html>
